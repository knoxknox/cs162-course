# Notes

1. Intro
2. Processes
3. IPC & Threads
4. Synchronization
5. Memory Management
6. File System (AFS, NFS)
7. Network (Sockets, TCP/IP)

# Intro

OS provide a VM abstraction to handle various hardware.<br/>
CPU operates in 2 different modes (user mode / kernel mode).<br/>
There is special 'sysmode' bit to switch from user mode to kernel mode.<br/>
Kernel mode provides an access to every resource and underlying hardware.<br/>
System calls provide an essential interface between a process and operating system.

Syscall:
```
user mode -> syscall -> kernel mode -> execute -> user mode
```

Hardware:
- I/O devices are managed by OS.<br/>
- They are operate independently of main CPU.<br/>
- Device uses interrupts to signal OS about event (IRQ).

Example of I/O:
1. Ethernet receives packet, writes packet into buffer;
2. Network Interface Card (NIC) - signals an interrupt;
3. CPU stops current instruction, saves current context;
4. CPU jumps to handler address from kernel vector table;
5. Ethernet device driver reads packet from buffer, processes packet;
6. Kernel restores saved context and reissues interrupted instruction;

Interrupt:
- software - unix signals, exceptions generated by programs (user mode);
- hardware - i/o, system timer, etc.. (signal to operating system / kernel mode);

```
---------------------------
| start executing program |
---------------------------
             |
---------------------------
|    fetch instruction    | <------------------- Yes
---------------------------                     |
             |                                  |
---------------------------                     |
|    decode instruction   |                     |
---------------------------                     |
             |                                  |
---------------------------                     |              ---------------
|   execute instruction   |                     |              | end program |
---------------------------                     |              ---------------
             |                                  |                     ^
---------------------------                     |                     |
|       interrupt ?       |                     |                     |
---------------------------                     |                     |
             |                  ---------------------------------     |
             ------------No---> | are there more instructions ? | --- No
             |                  ---------------------------------
             | Yes                              ^
             |                                  |
---------------------------                     |
|  service the interrupt  |                     |
---------------------------                     |
             |                                  |
              \                                 |
               -----------Processor----------   |
               |   Halts thread execution   |   |
               |     Saves thread state     |   |
               | Executes interrupt handler |   |
               ------------------------------   |
              /                                 |
             |                                  |
---------------------------                     |
|     resume execution    | --------------------
---------------------------
```
